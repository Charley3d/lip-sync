name: Simple Build

on:
  push:
    branches: [ master ]
  workflow_dispatch:
  
jobs:
  build-extension:
      name: Blender Extension Build
      runs-on: ubuntu-latest

      steps:
        - name: Checkout repo
          uses: actions/checkout@v4

        - name: Install Blender via Snap
          run: sudo snap install blender --classic

        - name: Build Extension with blender
          run: blender --command extension build --split-platforms

          # Not used for now but will be used when automating releases
#        - name: Get generated zip filenames
#          id: get-zips
#          run: |
#            ZIP_NAMES=$(ls ./*.zip | tr '\n' ' ')
#            echo "ZIP_NAMES=$ZIP_NAMES" >> $GITHUB_OUTPUT

        # Upload the full release of Blender Add-on
        - name: Upload Blender Addon
          uses: actions/upload-artifact@v4
          with:
            name: extension-builds
            path: ./*.zip
